"use strict";(self.webpackChunkreact_widget_template=self.webpackChunkreact_widget_template||[]).push([[647],{360:(e,t,s)=>{s.d(t,{A:()=>n});var o=s(2725),a=s(3862),r=s(3277);const n=()=>{const{showSuccessToast:e,showErrorToast:t}=(0,o.A)();return{fetchRevisionsAndParents:async(e,t,s)=>{if(!s)return void console.error("[Fetch Revisions] \u274c Missing relative path.");try{const o=await a.A.post("/revFloat/getParents",{data:{id:e,type:t,relativePath:s}});if(200===o.status){return o.data}throw new Error("[Fetch Revisions] HTTP error! status: ".concat(o.status))}catch(o){return console.error("[Fetch Revisions] \u274c Error occurred:",o),null}},replaceRevisions:async(s,o,n)=>{try{const t=await a.A.post("/revFloat/floatRevisions",{SelectedParents:s,DroppedData:o,userEmail:n});if(200===t.status)return console.log("Replacement successful:",t.data),e(r.hG),{success:!0};throw new Error("[Replacement API] HTTP error! status: ".concat(t.status))}catch(i){return console.error("Error during replacement:",i),t(r.mK),{success:!1,error:i.message}}}}}},759:(e,t,s)=>{s.d(t,{A:()=>u});var o=s(5043),a=(s(4119),s(3637)),r=s(8012),n=s(7419),i=s(4428),l=s(579);const c=e=>{let{widgetType:t}=e;const s=(0,n.A)(),c=(0,i.A)(),d=(0,r.A)(),u=(0,n.A)(),{initializeDroppableArea:p}="PlantAssignment"===t?s:"bosWidget"===t?c:"mcoimpactreport"===t?u:d,m=(0,o.useRef)(!1);return(0,o.useEffect)((()=>{m.current||(p(),m.current=!0)}),[]),(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"droppable-container mt-4",children:[(0,l.jsx)(a.A,{style:{width:"90px",height:"90px"},src:"https://thewhitechamaleon.github.io/testrapp/images/drag.png",alt:"Data Collect",className:"search-icon"}),(0,l.jsx)("span",{className:"drag-and-drop-text",children:"Drag and Drop"}),(0,l.jsxs)("div",{className:"divider-container",children:[(0,l.jsx)("hr",{className:"divider"}),(0,l.jsx)("span",{className:"divider-text",children:"or"}),(0,l.jsx)("hr",{className:"divider"})]})]})})};var d=s(4816);const u=e=>{let{data:t,widgetType:s}=e;const[a,r]=(0,o.useState)(!1);return(0,l.jsxs)("div",{className:"card-with-drag-and-drop ".concat(a?"dragging":""),children:[(0,l.jsx)(c,{widgetType:s}),(0,l.jsx)(d.A,{data:t,onDragStart:()=>{r(!0)},onDragEnd:()=>{r(!1)}})]})}},1397:(e,t,s)=>{s.d(t,{A:()=>d});var o=s(5043),a=s(1666),r=s(2691),n=s(4282),i=s(3910),l=s(7929),c=s(579);const d=e=>{let{onSearch:t,disabled:s}=e;const[d,u]=(0,o.useState)(""),p=(0,o.useRef)(null);return(0,c.jsxs)("div",{className:"search-content-container d-flex align-items-center",children:[(0,c.jsx)(i.g,{icon:l.$UM,onClick:()=>{d.trim()&&t(d)},className:"search-icon"}),(0,c.jsx)("span",{className:"ms-4 drag-and-drop-text flex-grow-1",children:(0,c.jsxs)(a.A,{children:[(0,c.jsx)(r.A.Control,{type:"text",ref:p,value:d,onChange:e=>{const t=e.target.value;u(t)},onKeyDown:e=>{"Enter"===e.key&&d.trim()&&t(d)},placeholder:"Search...",disabled:s}),d&&(0,c.jsx)(n.A,{variant:"btn-link",onClick:()=>{u(""),p.current.focus()},className:"clear-button",children:"\u2716"})]})})]})}},2268:(e,t,s)=>{s.d(t,{I:()=>a});var o=s(6047);const a=async()=>{try{let e=window.widget.getValue("Credentials");const t=await(0,o.fV)();console.log("Security Context is:",e);const s="https://oi000186152-us1-space.3dexperience.3ds.com/enovia/resources/v1/application/CSRF?tenant=OI000186152",a=await new Promise(((e,o)=>{t.authenticatedRequest(s,{method:"GET",type:"json",onComplete:e,onFailure:o})})),r=a.csrf.name,n=a.csrf.value,i="SecurityContext",l=e;return{[r]:n,[i]:l}}catch(e){return void console.error("[CSRF] Failed to fetch token:",e)}}},2725:(e,t,s)=>{s.d(t,{A:()=>c,_:()=>l});var o=s(9379),a=s(45),r=s(2115);const n=["message","type","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","pauseOnFocusLoss","draggable","theme","transition","progress"],i=()=>{const e=e=>{let{message:t,type:s="default",position:i="top-right",autoClose:l=2e3,hideProgressBar:c=!1,closeOnClick:d=!0,pauseOnHover:u=!1,pauseOnFocusLoss:p=!1,draggable:m=!0,theme:h="light",transition:g=r.br,progress:v}=e,f=(0,a.A)(e,n);(r.oR[s]||r.oR)(t,(0,o.A)({position:i,autoClose:l,hideProgressBar:c,closeOnClick:d,pauseOnHover:u,draggable:m,theme:h,transition:g,progress:v},f))};return{showToast:e,showSuccessToast:function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e((0,o.A)({message:t,type:"success"},s))},showErrorToast:function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e((0,o.A)({message:t,type:"error"},s))},showInfoToast:function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e((0,o.A)({message:t,type:"info"},s))},showWarningToast:function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e((0,o.A)({message:t,type:"warn"},s))}}},l=()=>{const{showToast:e,showSuccessToast:t,showErrorToast:s,showInfoToast:a,showWarningToast:r}=i();return{showToastWithProgress:function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e((0,o.A)({message:t,progress:1},s))},showSuccessToastWithProgress:function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t(e,(0,o.A)({progress:1},s))},showErrorToastWithProgress:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};s(e,(0,o.A)({progress:1},t))},showInfoToastWithProgress:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a(e,(0,o.A)({progress:1},t))},showWarningToastWithProgress:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(e,(0,o.A)({progress:1},t))}}},c=i},3728:(e,t,s)=>{s.d(t,{A:()=>l});var o=s(9379),a=s(45),r=(s(5043),s(4282)),n=s(579);const i=["variant","size","type","disabled","onClick","className","title","text","imageSrc"],l=e=>{let{variant:t="primary",size:s="md",type:l="button",disabled:c=!1,onClick:d,className:u="",title:p,text:m,imageSrc:h}=e,g=(0,a.A)(e,i);return(0,n.jsxs)(r.A,(0,o.A)((0,o.A)({variant:t,size:s,type:l,disabled:c,onClick:d,className:u,title:p},g),{},{children:[h&&(0,n.jsx)("img",{src:h,alt:m,style:{width:"20px",height:"20px",marginRight:"5px"}})," ",m]}))}},4050:()=>{},4119:()=>{},4428:(e,t,s)=>{s.d(t,{A:()=>m});var o=s(5043),a=s(3003),r=s(5645),n=(s(6724),s(314)),i=s(2725),l=s(3277),c=s(9379),d=s(2268),u=s(6047);const p=()=>{const{showErrorToast:e}=(0,i.A)(),t=(0,a.wA)(),s="https://oi000186152-us1-space.3dexperience.3ds.com/enovia";let o=window.widget.getValue("email");console.log("Email in useBOSWidget:",o);return{handleBOSWidget:async(o,a,n,i,p,m)=>{try{console.log("Object id is:",n),console.log("Object type is:",i),t((0,r.Ve)(!0));const A=await(0,d.I)();if(!A)return void e(l.rK);console.log("[useBOSWidget] CSRF Headers:",A);let b="".concat(s,"/resources/v1/modeler/documents/parentId/").concat(n,"?parentRelName=SpecificationDocument"),y="Document"===i?"to":"from",C="".concat(b,"&parentDirection=").concat(y),S=await(0,u.ui)("GET",C,"",A);if(console.log("SpecDetails Response:",S),S&&S.status&&S.output.data.length>0){var h,g,v,f;let D,x,P=S.output.data.map((e=>({id:e.id,title:e.dataelements.title&&""!==e.dataelements.title.trim()?e.dataelements.title:e.dataelements.secondaryTitle,revision:e.dataelements.revision,state:e.dataelements.stateNLS,name:e.dataelements.name})));if(console.log("[useBOSWidget] Extracted Spec Documents:",P),"Document"===i){const E={data:[]};P.forEach((e=>{const t={id:e.id,identifier:e.id,type:"VPMReference",source:"".concat(s),relativePath:"/resources/v1/modeler/dseng/dseng:EngItem/".concat(e.id)};E.data.push(t)}));const I="".concat(s,"/resources/v1/modeler/dslc/version/getGraph"),O=await(0,u.ui)("POST",I,E,A);function N(e){if(/^\d+$/.test(e))return parseInt(e,10);let t=0;for(let s=0;s<e.length;s++)t=26*t+(e.charCodeAt(s)-"A".charCodeAt(0)+1);return t}console.log("response is:",O),O.output.results.forEach((e=>{const t=e.versions.reduce(((e,t)=>N(t.revision)>N(e.revision)?t:e));P=P.map((s=>e.versions.some((e=>e.id===s.id))?(0,c.A)((0,c.A)({},s),{},{isLatestRevision:s.id===t.id?"TRUE":"FALSE"}):s))})),console.log("ChildObjectDocument is:",P)}"Document"===i?(x="https://saasimplementationserverdev.azurewebsites.net/bosAttribute/getLatestSpecItemDetails",D={SpecName:p,SpecRevision:m,Items:P.map((e=>({ItemName:e.name,ItemRevision:e.revision})))}):(x="https://saasimplementationserverdev.azurewebsites.net/bosAttribute/getLatestItemSpecDetails",D={ItemName:p,ItemRevision:m,Specifications:P.map((e=>({SpecName:e.name,SpecRevision:e.revision})))}),console.log("Requested Body is:",D);const R=await(0,u.Fd)("POST",x,D);console.log("the response from node API is:",R);let j=[];null!==R&&void 0!==R&&null!==(h=R.data)&&void 0!==h&&null!==(g=h.data)&&void 0!==g&&g.Specifications?R.data.data.Specifications.forEach((e=>{let t=P.find((t=>t.name===e.SpecName&&t.revision===e.SpecRevision));j.push({childState:(null===t||void 0===t?void 0:t.state)||"",childTitle:(null===t||void 0===t?void 0:t.title)||"",childLatest:(null===t||void 0===t?void 0:t.isLatestRevision)||"FALSE",childName:e.SpecName,childRevision:e.SpecRevision,PrintOnPurchaseOrderRequired:e.PrintOnPurchaseOrderRequired,PrintOnWorkOrderRequired:e.PrintOnWorkOrderRequired,WorkOrderDocumentRequired:e.WorkOrderDocumentRequired,PrintOnReportOrderRequired:e.PrintOnReportOrderRequired,"SAP/JDE":e["SAP/JDE"]})})):null!==R&&void 0!==R&&null!==(v=R.data)&&void 0!==v&&null!==(f=v.data)&&void 0!==f&&f.Items?R.data.data.Items.forEach((e=>{let t=P.find((t=>t.name===e.ItemName&&t.revision===e.ItemRevision));j.push({childState:(null===t||void 0===t?void 0:t.state)||"",childTitle:(null===t||void 0===t?void 0:t.title)||"",childName:e.ItemName,childRevision:e.ItemRevision,childLatest:(null===t||void 0===t?void 0:t.isLatestRevision)||"FALSE",PrintOnPurchaseOrderRequired:e.PrintOnPurchaseOrderRequired,PrintOnWorkOrderRequired:e.PrintOnWorkOrderRequired,WorkOrderDocumentRequired:e.WorkOrderDocumentRequired,PrintOnReportOrderRequired:e.PrintOnReportOrderRequired,"SAP/JDE":e["SAP/JDE"]})})):console.warn("[useBOSWidget] Unexpected API response format."),console.log("[useBOSWidget] Final Merged Data for Dispatch:",j),t((0,r.Xv)(j))}else console.warn("[useBOSWidget] No connected childs."),t((0,r.Xv)([]))}catch(w){throw console.error("[useBOSWidget] Error:",w),w}finally{t((0,r.Ve)(!1))}}}},m=()=>{const{showErrorToast:e}=(0,i.A)(),{handleBOSWidget:t}=p(),s=(0,a.d4)((e=>e.droppedObject.isDropped)),c=(0,a.d4)((e=>e.droppedObject.loading)),d=(0,a.wA)(),u=(0,o.useCallback)((async s=>{try{const i=await(0,n.Sj)({dataItems:s});if(i.success){d((0,r.um)({cardData:i.data.cardData}));const e=i.data.cardData;var o,a;if(console.log("[Dragged Items are]",e),d((0,r.Rr)(!0)),i)await t(e["Collaborative Space"],e["Maturity State"],null===(o=s[0])||void 0===o?void 0:o.objectId,null===(a=s[0])||void 0===a?void 0:a.objectType,e.Name,e["Dropped Revision"])}else e(l.wX)}catch(i){console.error("[FetchObjectDetails] Error fetching details:",i),e(l.wX)}finally{d((0,r.r1)(!1))}}),[d,t]),m=(0,o.useCallback)((async t=>{(0,r.r1)(!0),console.log("[handleDrop] handleDrop called with dataItems:",t);try{t&&t.length>0?await u(t):console.warn("[handleDrop] No data items to process.")}catch(s){(0,r.r1)(!1),console.error("[Drop] Error in handleDrop:",s),console.log("[handleDrop] Error in handleDrop, setting loading to false"),e(l.nz)}}),[u,e]);return{initializeDroppableArea:(0,o.useCallback)((()=>{s?console.log("[initializeDroppableArea] \u23f3 isDropped is already true. Skipping reset."):(console.log("[initializeDroppableArea] \ud83d\ude80 Resetting isDropped to false..."),d((0,r.Rr)(!1)));const t=setInterval((()=>{const s=document.querySelector(".droppable-container");s&&(clearInterval(t),(0,n.pn)(s,m,d,e))}),100);return()=>clearInterval(t)}),[m,d]),loading:c,handleDrop:m}}},4675:(e,t,s)=>{s.d(t,{A:()=>n});var o=s(9379),a=s(5043),r=s(6047);const n=()=>{const[e,t]=(0,a.useState)(null),[s,n]=(0,a.useState)(null);(0,a.useEffect)((()=>{(async()=>{try{const e=await(0,r.qZ)();n(e)}catch(e){console.error("[useInterComSearch] Error initializing InterCom:",e)}})()}),[]),(0,a.useEffect)((()=>()=>{e&&e.disconnect()}),[e]);return{performSearch:(0,a.useCallback)(((e,a,r)=>{var n;if(!s)return void console.warn("[useInterComSearch] InterCom is not loaded yet.");const i="socket"+(new Date).toISOString().replace(/[-:]/g,""),l=new s.Socket(i,{dispatchRetryInternal:0});l.subscribeServer("SearchComServer"),t(l),console.log("[useInterComSearch] performSearch called with:",e,a);const c=null===(n=window.widget)||void 0===n?void 0:n.id,d=(0,o.A)((0,o.A)({},a),{},{widget_id:c,app_socket_id:i,default_search_criteria:e});console.log("[useInterComSearch] Dispatching RegisterContext event with:",d),l.dispatchEvent("RegisterContext",d),l.dispatchEvent("InContextSearch",d);console.log("[useInterComSearch] Adding listener for Selected_Objects_search"),l.addListener("Selected_Objects_search",(e=>{console.log("[useInterComSearch] Search results received:",e),r&&r(e)}))}),[s])}}},4816:(e,t,s)=>{s.d(t,{A:()=>u});var o=s(5043),a=(s(8611),s(4220)),r=s(5284),n=s(3637),i=s(6047),l=s(3003),c=s(579);const d=e=>{let{data:t,isColumn:s,onDragStart:a,onDragEnd:r}=e;const n=(0,o.useRef)(null),d=(0,l.d4)((e=>e.droppedObject.droppedObjectData.initialDraggedData));return(0,o.useEffect)((()=>{n.current&&d&&(0,i.eB)(n.current,d,a,r)}),[t,d,a,r]),t?(0,c.jsxs)("div",{className:"d-flex ".concat(s?"flex-column":"flex-row"),children:[(0,c.jsx)("h5",{ref:n,className:"mb-1 text-start title ".concat(s?"":"me-2"),children:t.title}),(0,c.jsxs)("ul",{className:"list-group d-flex flex-row flex-sm-row flex-wrap justify-content-between pb-3 pb-md-0 ".concat(s?"":"w-75"),children:[(0,c.jsxs)("li",{className:"list-group-item flex-grow-1 text-start mx-0 ps-0 pb-0 ".concat(s?"":"d-flex flex-row justify-content-around"),style:{border:"0"},children:[(0,c.jsxs)("p",{children:[(0,c.jsx)("b",{children:"Type:"})," ",(0,c.jsx)("span",{className:"list-text",title:t.type,children:t.type})]}),(0,c.jsxs)("p",{children:[(0,c.jsx)("b",{children:"Owner:"})," ",(0,c.jsx)("span",{className:"list-text",title:t.owner,children:t.owner})]}),s&&(0,c.jsxs)("p",{children:[(0,c.jsx)("b",{children:"Maturity State:"})," ",(0,c.jsx)("span",{className:"list-text",title:t["Maturity State"],children:t["Maturity State"]})]})]}),s&&(0,c.jsxs)("li",{className:"list-group-item flex-grow-1 text-start mx-0 pt-0",style:{border:"0",paddingLeft:"0"},children:[(0,c.jsxs)("p",{children:[(0,c.jsx)("b",{children:"Dropped Revision :"})," ",(0,c.jsx)("span",{className:"list-text",title:t["Dropped Revision"],children:t["Dropped Revision"]})]}),(0,c.jsxs)("p",{children:[(0,c.jsx)("b",{children:"Latest Released Revision:"})," ",(0,c.jsx)("span",{className:"list-text",title:t["Latest Released Revision"],children:t["Latest Released Revision"]})]}),(0,c.jsxs)("p",{children:[(0,c.jsx)("b",{children:"Collabspace:"})," ",(0,c.jsx)("span",{className:"list-text",title:t["Collaborative Space Title"],children:t["Collaborative Space Title"]})]})]}),(0,c.jsx)("li",{className:"list-group-item flex-grow-1 text-start mx-0 ".concat(s?"":"d-flex flex-row"),style:{border:"0",paddingLeft:"0"},children:"Document"!==t.type&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("p",{children:[(0,c.jsx)("b",{children:"CAD Format:"})," ",(0,c.jsx)("span",{className:"list-text",title:t["CAD Format"],children:t["CAD Format"]})]}),(0,c.jsxs)("p",{children:[(0,c.jsx)("b",{children:"EIN:"})," ",(0,c.jsx)("span",{className:"list-text",title:t.EIN,children:t.EIN})]})]})}),(0,c.jsx)("div",{className:"d-none d-md-flex align-items-stretch",children:(0,c.jsx)("div",{className:"vr"})}),(0,c.jsx)("div",{className:"d-flex d-md-none w-100",children:(0,c.jsx)("hr",{className:"w-100"})}),(0,c.jsx)("li",{className:"list-group-item flex-grow-1 text-start mx-0",style:{border:"0"},children:(0,c.jsx)("p",{className:"description-container",title:t.Description,children:t.Description})})]})]}):null},u=e=>{let{data:t,onDragStart:s,onDragEnd:i}=e;const[l,u]=(0,o.useState)(!0);return(0,c.jsxs)(a.A,{className:"d-flex flex-row mt-4 border-0 ",style:{width:"100%"},children:[(0,c.jsx)("div",{className:"pb-3 d-none d-md-block me-5 ms-4",children:(0,c.jsx)(a.A.Img,{className:"".concat(l?"img-thumbnail":"image-resize img-thumbnail"," "),src:t.imageURL,alt:"Card image"})}),(0,c.jsx)(r.A,{className:"".concat(l?"p-0":"p-0 layout-change"," "),children:(0,c.jsx)(d,{data:t,isColumn:l,onDragStart:s,onDragEnd:i})}),(0,c.jsx)("button",{className:"me-2 p-0 btn btn-link accordion-toggle",onClick:()=>{u(!l)},children:(0,c.jsx)(n.A,{src:"https://khanfarzan17.github.io/tedting-revision-float/images/arrow.png",alt:"downArrow",className:"rotatable ".concat(l?"rotated":"")})})]})}},6713:(e,t,s)=>{s.d(t,{A:()=>a});s(5043);var o=s(579);const a=()=>(0,o.jsx)("div",{className:"loader-container",children:(0,o.jsx)("div",{className:"loader"})})},6724:(e,t,s)=>{s.d(t,{A:()=>p});var o=s(3003),a=s(9379),r=s(6047);var n=s(9332);const i=async(e,t)=>{let s={CAAtt:[]};console.log("We are into Search CA Details");const o="https://oi000186152-us1-space.3dexperience.3ds.com/enovia";try{const a=await(0,r.fV)(),n=async e=>new Promise(((s,o)=>{a.authenticatedRequest(e,{method:"GET",headers:t,type:"json",onComplete:e=>{console.log("Received response:",e),s(e)},onFailure:e=>{console.error("Request failed:",e),o(e)}})}));let i="".concat(o,"/resources/v1/modeler/dsrt/routes/search?searchStr=").concat(e);const l=await n(i),c=((null===l||void 0===l?void 0:l.data)||[]).find((e=>"Route"===e.type));if(c){const t=c.identifier,a=c.state,r="".concat(o,"/resources/v1/modeler/dsrt/routes/").concat(t),i=await n(r),l=((null===i||void 0===i?void 0:i.data)||[]).find((e=>"Change Action"===e.type));if(l){const e=l.identifier,t="".concat(o,"/resources/v1/modeler/dslc/changeaction/").concat(e,"?$fields=proposedChanges,flowDown"),a=await n(t);if(a)for(const r of a.isFlowDownOf||[])if("Change Action"===r.type){const e="".concat(o,"/resources/v1/modeler/dslc/changeaction/").concat(r.identifier),t=await n(e);t&&s.CAAtt.push({CATitle:t.title,CAState:t.state})}}s.MCOState=a,s.MCOTitle=e}return console.log("Final CA Details",s),s}catch(a){throw console.error("Error in SearchCA:",a),a}};var l=s(5645),c=(s(5043),s(3277)),d=s(2725),u=s(2268);const p=()=>{const{showErrorToast:e}=(0,d.A)(),t=(0,o.wA)();let s=window.widget.getValue("email");console.log("Email in usePlantAssignment:",s);return{handlePlantAssignment:async(o,d,p,g)=>{try{t((0,l.Ve)(!0));const v=await(0,u.I)();if(!v)return void e(c.rK);console.log("[UsePlantAssignment] Headers:",v);let f=[];if("Change Action"===g){let e=!1;console.log("The object Type is Change Action");const s=async()=>{const t="https://oi000186152-us1-space.3dexperience.3ds.com/enovia/resources/v1/modeler/dslc/changeaction/".concat(p,"?%24fields=proposedChanges,realizedChanges"),s=await(0,r.ui)("GET",t,"",v);if(console.log("Response from Change Action URL:",s),s.status&&s.output){const t=s.output.realizedChanges.map((e=>e.where.identifier)),o=s.output.proposedChanges.map((async s=>{let o=s.where.identifier,a=s.where.type;if("NewVersion"===s.target){const e=await async function(e,t,s){const o="https://oi000186152-us1-space.3dexperience.3ds.com/enovia/resources/v1/modeler/dslc/version/getGraph",a="";try{const n="Raw_Material"===t?"/resources/v1/modeler/dsrm/dsrm:RawMaterial/".concat(e):"/resources/v1/modeler/dseng/dseng:EngItem/".concat(e),i={data:[{id:e,identifier:e,type:t,source:"https://oi000186152-us1-space.3dexperience.3ds.com/enovia",relativePath:n}]},l=await(0,r.ui)("POST",o,JSON.stringify(i),s);if(!l.status||!l.output)return console.error("API response does not contain the expected 'status' and 'output'."),a;for(const t of l.output.results)if(t.ancestors&&t.ancestors.some((t=>t.identifier===e)))return t.id}catch(n){return console.error("Error fetching getLatestRevision for ".concat(e,":"),n),a}}(o,a,v);t.includes(e)&&(o=e)}if("Raw_Material"!==a&&"VPMReference"!==a){e=!0;const t=await async function(e,t){let s="";s="https://oi000186152-us1-space.3dexperience.3ds.com/enovia/resources/v1/modeler/dsmfg/dsmfg:MfgItem/".concat(e,"/dsmfg:ScopeEngItem");try{const o=await(0,r.ui)("GET",s,"",t);return o.status&&o.output?{identifier:o.output.member[0].ScopeEngItem.identifier,type:o.output.member[0].ScopeEngItem.type}:(console.log("No valid response for identifier ".concat(e)),{})}catch(o){return console.error("Error fetching item details for ".concat(e,":"),o),{}}}(o,v);console.log("MFG Details are:",t),o=t.identifier,a=t.type}if(void 0!==o&&void 0!==a)try{var n,i;const[e,t]=await Promise.all([m(o,v),h(o,a,v)]);f.push({ItemId:o,ItemType:a,ItemState:(null===t||void 0===t?void 0:t.member[0].state)||"N/A",ItemTitle:(null===t||void 0===t?void 0:t.member[0].title)||"N/A",ItemRev:(null===t||void 0===t?void 0:t.member[0].revision)||"N/A",ItemMBOM:(null===t||void 0===t||null===(n=t.member[0])||void 0===n||null===(i=n["dseno:EnterpriseAttributes"])||void 0===i?void 0:i.EMR_hasMBOM)||"N/A",ItemPlants:e})}catch(l){console.error("Error processing change for item ".concat(o,":"),l)}}));await Promise.all(o)}else console.error("Invalid response structure or no proposed changes.")},a=async()=>{const e=await(0,n.g)([o],v,p);console.log("Parallel API response:",e),t((0,l.QL)(e))};await Promise.all([s(),a()]),t((0,l.Ve)(!1)),t((0,l.OL)(f)),t((0,l.Dr)(e)),t((0,l.lT)(v))}else{const e=await(async(e,t,s)=>{try{const o="https://oi000186152-us1-space.3dexperience.3ds.com/enovia";console.log("[UserGroup Status] ProductId: ",t);const n=await(0,r.fV)();let i="".concat(o,"/resources/v1/modeler/dslc/sharing/getSharing");const l=await new Promise(((s,o)=>{n.authenticatedRequest(i,{method:"POST",headers:(0,a.A)((0,a.A)({},e),{},{"Content-Type":"application/json"}),data:JSON.stringify({data:[{objectID:t}]}),type:"json",onComplete:s,onFailure:o})}));console.log("[Assigned Plant Service] Data received:",l);let c=[],d={groups:[]};if(l&&(l.results.forEach((e=>{e.sharings.userGroups.forEach((e=>{"Can Edit"===e.access&&d.groups.push({uri:e.userGroupID.replace(/[<>]/g,"")})}))})),d.groups.length>0)){let e="https://oi000186152-us1-usersgroup.3dexperience.3ds.com/3drdfpersist/resources/v1/usersgroup/groups?select=uri,members,title";const t=await new Promise(((t,s)=>{n.authenticatedRequest(e,{method:"POST",headers:{"Content-Type":"application/json"},data:JSON.stringify(d),type:"json",onComplete:t,onFailure:s})}));console.log("Group Response is:",t),t&&(c=t.groups.filter((e=>e.members.includes(s))).map((e=>e.title)))}return console.log("[UserGroup Status] User Groups:",c),c}catch(o){throw console.error("[UserGroup Status] Error occurred:",o),o}})(v,p,s);console.log("[Plant Assignment] User Groups:",e);let c=[...e,o];console.log("[Use Plant Assignment] All CollabSpaces:",c);let u=[];if(c.length>0?(u=await(0,n.g)(c,v,p),console.log("[Use Plant Assignment] All Plants:",u)):console.warn("[Use Plant Assignment] No CollabSpaces found."),u.length>0){const e=await(async(e,t,s)=>{try{const o="https://oi000186152-us1-space.3dexperience.3ds.com/enovia";console.log("[Assigned Plant Service] Plant Members:",e);const a="".concat(o,"/resources/v1/modeler/dslib/dslib:ClassifiedItem/").concat(s,"?$mask=dslib:ClassificationAttributesMask"),n=await(0,r.fV)(),l=await new Promise(((e,s)=>{n.authenticatedRequest(a,{method:"GET",headers:t,type:"json",onComplete:e,onFailure:s})}));console.log("[Assigned Plant Service] Data received:",l);let c=[],d=[],u=l.member[0].ClassificationAttributes.member;return await Promise.all(u.map((async s=>{console.log("Class Item is ",s);for(let o of e)if(s.ClassID===o.id){let e=o.title;e=e.replace("Plant","").replace(/\s+/g,"");let a={id:s.ClassID,title:o.title};const r=s.Attributes.map((s=>s.name.includes("FlowDownCA")&&s.value?i(s.value,t).then((e=>{if(e){console.log(e),a.MFGChange=null===e||void 0===e?void 0:e.MCOTitle,a.MFGStatus=null===e||void 0===e?void 0:e.MCOState;let t="",s="";e.CAAtt.forEach((e=>{t+=","+e.CATitle,s+=","+e.CAState})),a.Change=t.slice(1),a.ChangeStatus=s.slice(1)}})):(a[s.name.replace(e,"").trim()]=s.value,Promise.resolve())));await Promise.all(r),c=[...c,a],console.log("Initial Assigned Classes",c),console.log("Processed Object:",a)}}))),console.log("[Assigned Plant Service] Initial Assigned Classes:",c),d=e.filter((e=>!c.some((t=>t.id===e.id)))),console.log("uniqueInAllclasses--:",d),{success:!0,data:{plantData:{allPlants:e,initialAssignedPlants:c,uniquePlants:d}}}}catch(o){return console.error("[Object Details] Failed to fetch data:",o),{success:!1,error:o}}})(u,v,p);console.log("[Use Plant Assignment]: ",e),e.success?(t((0,l.Lq)(e.data.plantData)),t((0,l.lL)(v))):console.error("Failed to fetch plant data.")}else console.warn("[Use Plant Assignment] No Plants found.");let m={};m="Raw_Material"===g?{success:!0,data:[]}:await(async(e,t)=>{const s="https://oi000186152-us1-space.3dexperience.3ds.com/enovia";let o="".concat(s,"/resources/v1/modeler/dseng/dseng:EngItem/");o+=t,o+="/expand";let n={expandDepth:1,type_filter_bo:["VPMReference"],type_filter_rel:["VPMInstance"]};try{console.log("[SearchCAService] ProductId is:",t);const i=await(0,r.fV)(),l=(t,s,o)=>new Promise(((r,n)=>{i.authenticatedRequest(t,{method:s,headers:(0,a.A)((0,a.A)({},e),{},{"Content-Type":"application/json"}),data:JSON.stringify(o),type:"json",onComplete:e=>{console.log("Received response:",e),r(e)},onFailure:e=>{console.error("Request failed:",e),n(e)}})})),c=await l(o,"POST",n);console.log("[Get CA Details Service] Data received:",c);const{member:d}=c;if(d){let e=c.member.filter((e=>("VPMReference"===e.type||"Raw_Material"===e.type)&&e.id!==t)).map((e=>({id:e.id,type:e.type,name:e.title,state:e.state})));return e.length>0&&await Promise.all(e.map((async e=>{if("released"===e.state.toLowerCase()){let t="".concat(s,"/resources/v1/modeler/dslib/dslib:ClassifiedItem/").concat(e.id,"?$mask=dslib:ClassificationAttributesMask");const o=await l(t,"GET","");console.log("classResponse->",o);const a=o.member.flatMap((e=>{var t;return null!==(t=e.ClassificationAttributes)&&void 0!==t&&t.member?e.ClassificationAttributes.member.map((e=>e.ClassID)):[]}));e.classes=a}}))),{success:!0,data:e}}}catch(i){return console.error("Error while Fetching",i),{success:!1,data:[],error:i}}})(v,p),console.log("Type After:",g),console.log("[Use Plant Assignment] Product Children:",m),m.success&&t((0,l.VG)(m.data));const h=await(async(e,t,s)=>{const o="https://oi000186152-us1-space.3dexperience.3ds.com/enovia";let n=!1,i=[],l={CAName:"",CAStatus:""};const c="".concat(o,"/resources/enorelnav/v2/navigate/setPreferences");let d={widgetId:"ENORIPE_Relations_Preview_2751_2038-15:33:22",relations:["caproposedwhere_from"],allRelationsMode:!1,publicationsMode:!1,computeWithInstances:!1,attributesForView:["ds6w:status","ds6w:type","ds6w:identifier","ds6w:label"],label:"ENXENG_AP-e1331143-1734517777960",lang:"en",ghostMode:!1},u="".concat(o,"/resources/enorelnav/v2/navigate/getEcosystem"),p={widgetId:"ENORIPE_Relations_Preview_2751_2038-15:33:22",responseMode:"objectsByPatterns",label:"ENXENG_AP-e1331143-1734517780491",ids:[t]};try{console.log("[Get CA Details] Product ID:",t);const m=await(0,r.fV)(),h=await new Promise(((t,s)=>{m.authenticatedRequest(c,{method:"POST",headers:(0,a.A)((0,a.A)({},e),{},{"Content-Type":"application/json"}),data:JSON.stringify(d),type:"json",onComplete:t,onFailure:s})}));if(console.log("[Get CA Details Service] Data received:",h),"OK"===h.status){const r=await new Promise(((t,s)=>{m.authenticatedRequest(u,{method:"POST",headers:(0,a.A)((0,a.A)({},e),{},{"Content-Type":"application/json"}),data:JSON.stringify(p),type:"json",onComplete:t,onFailure:s})}));console.log("[Get CA Details Service] Data received:",r),r.objectsByPatterns.caproposedwhere_from&&await Promise.all(r.objectsByPatterns.caproposedwhere_from.map((async a=>{const r=a["ds6w:status"].slice(14),c=a["ds6w:label"];if("Complete"!==r){let d="".concat(o,"/resources/v1/modeler/dslc/changeaction/").concat(a.id,"?$fields=proposedChanges,flowDown");const u=await new Promise(((t,s)=>{m.authenticatedRequest(d,{method:"GET",headers:e,type:"json",onComplete:t,onFailure:s})}));Array.isArray(u.proposedChanges)&&u.proposedChanges.forEach((e=>{i.push({identifier:e.where.identifier,action:e.whats[0].what})})),n="released"!==s.toLowerCase()||i.some((e=>e.identifier===t&&"Modify"===e.action)),n&&(l.CAName=c,l.CAStatus=r)}})))}else console.error("Unable to Fetch the ");return console.log("Status is coming inside 7"),console.log("Response Object is:",n),{success:!0,data:n,CAData:l,proposedChanges:i}}catch(m){throw console.error("Failed Request:",{url:c,headers:e,body:d,error:m}),m}})(v,p,d);console.log("[Use Plant Assignment] CA Details:",h),h.success&&(t((0,l.ug)(h.data)),t((0,l.aB)(h.proposedChanges)),t((0,l.hF)(h.CAData))),console.log("[Plant Assignment] All services executed successfully.")}}catch(v){console.error("[Plant Assignment] Error:",v),e("An error occurred while fetching plant assignment data.")}finally{t((0,l.Ve)(!1))}}}};async function m(e,t){const s=[],o="https://oi000186152-us1-space.3dexperience.3ds.com/enovia/resources/v1/modeler/dslib/dslib:ClassifiedItem/".concat(e,"?$mask=dslib:ClassificationAttributesMask");try{const a=await(0,r.ui)("GET",o,"",t);console.log("Response for identifier ".concat(e,":"),a),a.output.member&&a.output.member[0].ClassificationAttributes?a.output.member[0].ClassificationAttributes.member.forEach((e=>{const t=e.ClassID;let o=null,a=null;e.Attributes.forEach((e=>{e.name.includes("PlantId")&&(o=e.value),e.name.includes("ERPStatus")&&(a=e.value)})),null!==o&&s.push({PlantName:o,PlantID:t,PlantERPStatus:a||"Pending"})})):console.log("No valid classification data for identifier ".concat(e))}catch(a){console.error("Error fetching assigned classes for ".concat(e,":"),a)}return s}async function h(e,t,s){let o="";o="Raw_Material"===t?"https://oi000186152-us1-space.3dexperience.3ds.com/enovia/resources/v1/modeler/dsrm/dsrm:RawMaterial/".concat(e):"https://oi000186152-us1-space.3dexperience.3ds.com/enovia/resources/v1/modeler/dseng/dseng:EngItem/".concat(e,"?mask=dsmveng:EngItemMask.Details");try{const t=await(0,r.ui)("GET",o,"",s);return t.status&&t.output?t.output:(console.log("No valid response for identifier ".concat(e)),{})}catch(a){return console.error("Error fetching item details for ".concat(e,":"),a),{}}}},7327:()=>{},7419:(e,t,s)=>{s.d(t,{A:()=>d});var o=s(5043),a=s(3003),r=s(5645),n=s(6724),i=s(314),l=s(2725),c=s(3277);const d=()=>{const{showErrorToast:e}=(0,l.A)(),{handlePlantAssignment:t}=(0,n.A)(),s=(0,a.d4)((e=>e.droppedObject.isDropped)),d=(0,a.d4)((e=>e.droppedObject.loading)),u=(0,a.wA)(),p=(0,o.useCallback)((async s=>{try{const n=await(0,i.Sj)({dataItems:s});if(n.success){u((0,r.um)({cardData:n.data.cardData}));const e=n.data.cardData;var o,a;if(console.log("[Dragged Items are]",e),u((0,r.Rr)(!0)),n)await t(e["Collaborative Space"],e["Maturity State"],null===(o=s[0])||void 0===o?void 0:o.objectId,null===(a=s[0])||void 0===a?void 0:a.objectType)}else e(c.wX)}catch(n){console.error("[FetchObjectDetails] Error fetching details:",n),e(c.wX)}finally{u((0,r.r1)(!1))}}),[u,t]),m=(0,o.useCallback)((async t=>{console.log("[handleDrop] handleDrop called with dataItems:",t);try{if(t&&t.length>0){var s;const o=null===(s=t[0])||void 0===s?void 0:s.objectType;if(!["VPMReference","Document","Raw_Material","Change Action"].includes(o))return void e(c.Zo);u((0,r.Rr)(!0)),console.log("[handleDrop] \ud83d\udd04 Force setting `loading = true`..."),u((0,r.r1)(!1)),setTimeout((()=>u((0,r.r1)(!0))),0),await p(t)}else console.warn("[handleDrop] No data items to process.")}catch(o){console.error("[Drop] Error in handleDrop:",o),u((0,r.r1)(!1)),console.log("[handleDrop] Error in handleDrop, setting loading to false"),e(c.nz)}}),[p,e]);return{initializeDroppableArea:(0,o.useCallback)((()=>{s?console.log("[initializeDroppableArea] \u23f3 isDropped is already true. Skipping reset."):(console.log("[initializeDroppableArea] \ud83d\ude80 Resetting isDropped to false..."),u((0,r.Rr)(!1)));const t=setInterval((()=>{const s=document.querySelector(".droppable-container");s&&(clearInterval(t),(0,i.pn)(s,m,u,e))}),100);return()=>clearInterval(t)}),[m,u]),loading:d,handleDrop:m}}},8012:(e,t,s)=>{s.d(t,{A:()=>d});var o=s(5043),a=s(3003),r=s(5645),n=s(360),i=s(314),l=s(2725),c=s(3277);const d=()=>{const{showErrorToast:e}=(0,l.A)(),{fetchRevisionsAndParents:t}=(0,n.A)(),s=(0,a.wA)(),d=(0,a.d4)((e=>e.droppedObject.isDropped)),u=(0,a.d4)((e=>e.droppedObject.loading)),p=(0,o.useCallback)((async o=>{try{const l=await(0,i.Sj)({dataItems:o});if(l.success){var a,n;const e=l.data.cardData.relativePath,[i]=await Promise.all([t(null===(a=o[0])||void 0===a?void 0:a.objectId,null===(n=o[0])||void 0===n?void 0:n.objectType,e)]);s((0,r.um)({cardData:l.data.cardData,parentDetails:i||[]})),console.log("[fetchObjectDetails] \u2705 Redux store updated.")}else e(c.wX)}catch(l){console.error("[FetchObjectDetails] Error fetching details:",l),e(c.wX)}finally{console.log("[fetchObjectDetails] \ud83c\udfc1 Ensuring loading is reset."),s((0,r.r1)(!1))}}),[s,t,e]),m=(0,o.useCallback)((async t=>{console.log("[handleDrop] handleDrop called with dataItems:",t);try{if(t&&t.length>0){var o;const a=null===(o=t[0])||void 0===o?void 0:o.objectType;if(!["VPMReference","Document","Raw_Material"].includes(a))return void e(c.Zo);s((0,r.Rr)(!0)),console.log("[handleDrop] \ud83d\udd04 Force setting `loading = true`..."),s((0,r.r1)(!1)),setTimeout((()=>s((0,r.r1)(!0))),0),await p(t)}else console.warn("[handleDrop] No data items to process.")}catch(a){console.error("[Drop] Error in handleDrop:",a),s((0,r.r1)(!1)),console.log("[handleDrop] Error in handleDrop, setting loading to false"),e(c.nz)}}),[p,e]);return{initializeDroppableArea:(0,o.useCallback)((()=>{d?console.log("[initializeDroppableArea] \u23f3 isDropped is already true. Skipping reset."):(console.log("[initializeDroppableArea] \ud83d\ude80 Resetting isDropped to false..."),s((0,r.Rr)(!1)));const t=setInterval((()=>{const o=document.querySelector(".droppable-container");o&&(clearInterval(t),(0,i.pn)(o,m,s,e))}),100);return()=>clearInterval(t)}),[m,s]),loading:u,handleDrop:m}}},9332:(e,t,s)=>{s.d(t,{g:()=>a});var o=s(6047);const a=async(e,t,s)=>{try{const s="https://oi000186152-us1-space.3dexperience.3ds.com/enovia";let a=[];console.log("[All Plant Service] CollabSpaces: ",e),console.log("[All Plant Service] headers: ",t);const r=await(0,o.fV)(),n=async e=>new Promise(((s,o)=>{r.authenticatedRequest(e,{method:"GET",headers:t,type:"json",onComplete:e=>{console.log("Received response:",e),s(e)},onFailure:e=>{console.error("Request failed:",e),o(e)}})})),i=e.map((async e=>{try{var t,o;const c="".concat(s,"/resources/v1/modeler/dslib/dslib:Library/search?$searchStr=").concat(e),d=null===(t=(await n(c)).member)||void 0===t||null===(o=t.find((t=>t.title===e)))||void 0===o?void 0:o.id;if(console.log("[All Plant Service] Library id is:",d),d){const e="".concat(s,"/resources/v1/modeler/dslib/dslib:Library/").concat(d,"?$mask=dslib:ExpandClassifiableClassesMask"),t=await n(e),{member:o}=t;if(o&&o.length>0){var r,i;console.log("[Library Data Service] Member found:",o);const e=null===(r=o[0])||void 0===r?void 0:r.ChildClasses;if((null===e||void 0===e||null===(i=e.member)||void 0===i?void 0:i.length)>0){var l;const t=null===(l=e.member[0].ChildClasses)||void 0===l?void 0:l.member;if(t&&t.length>0){const e=t.filter((e=>!a.some((t=>t.id===e.id))));a=[...a,...e]}}}}}catch(c){throw console.error("Error processing group:",e,c),c}}));return await Promise.all(i),a}catch(a){throw console.error("[All Plant Service] Error occurred:",a),a}}},9555:()=>{},9959:()=>{}}]);
//# sourceMappingURL=647.77dc5e09.chunk.js.map