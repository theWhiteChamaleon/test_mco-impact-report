"use strict";(self.webpackChunkreact_widget_template=self.webpackChunkreact_widget_template||[]).push([[403],{3127:(e,s,t)=>{t.d(s,{Bx:()=>n,Eo:()=>r,iu:()=>i});var o=t(9379),l=t(6047);const a=(e,s)=>{console.log("Data Received for ID Extraction:",e),console.log("[PlantAssignment] All Plants Data:",s);const t=e.map((e=>{const t=e.title.replace(/\s+/g,"").replace(/plant/i,""),o=s.find((e=>e.title.replace(/\s+/g,"").replace(/plant/i,"").toLowerCase()===t.toLowerCase()));return o?o.id:null})).filter((e=>null!==e));return console.log("Extracted IDs (newClasses):",t),t},n=async(e,s,t,o)=>{console.log("allPlants",e),console.log("removedTitles",s);const n=a(s,e);if(n.length>0){let e="https://saasimplementationserverdev.azurewebsites.net/plantAssignment/declassifyProductToClass",s={id:t,type:o,classes:n};const a=await(0,l.Fd)("POST",e,s);console.log("declassifyResponse:",JSON.stringify(a))}},r=async(e,s,t,o,n,r,i)=>{console.log("Data Received for handleAddData:",e);const c=a(e,s);console.log("newClasses before filtering:",c),console.log("productChilds",r);const d=r.filter((e=>{if("released"===e.state.toLowerCase()){return!n.find((s=>s.identifier===e.id&&"modify"===s.action.toLowerCase()))}return!1}));console.log("NotPropagableChilds ARE:",d);const u=[];c.forEach((e=>{const s=d.filter((s=>!s.classes.includes(e))).map((e=>e.name)).join(", ");""!==s&&"Undefined"!==s&&u.push({ClassID:e,Childs:s})})),console.log("error object savetable",u);let h="";u.forEach((e=>{var t;const o=null===(t=s.find((s=>s.id===e.ClassID)))||void 0===t?void 0:t.title,l="Unable to classify product in ".concat(o," due to unclassified child items: ").concat(e.Childs);h+="".concat(l,"\n")})),console.log("Final Message:\n",h);const g=c.filter((e=>!u.some((s=>s.ClassID===e))));if(console.log("Filtered New Classes (excluding errored ones):",g),g.length>0){const e="https://saasimplementationserverdev.azurewebsites.net/plantAssignment/classifyProductToClass",s={id:t,type:o,classes:g,mode:"classifyParent"};console.log("Classify API Body:",s);try{const t=await(0,l.Fd)("POST",e,s);console.log("Classify Response:",JSON.stringify(t))}catch(m){console.error("Error in Classify API Call:",m)}}if(g.length>0&&r.length>0&&"VPMReference"===o&&i){let e="https://saasimplementationserverdev.azurewebsites.net/plantAssignment/classifyProductToClass",s={id:t,type:o,classes:g,childs:r,mode:"classifychilds"};const a=await(0,l.Fd)("POST",e,s);console.log("child classifyResponse:",JSON.stringify(a))}return{success:!0,message:"Data saved successfully",ErrorObject:u,Finalmessage:h}},i=async(e,s,t,a,n,r,i,c,d,u,h)=>{try{const e="https://oi000186152-us1-space.3dexperience.3ds.com/enovia";console.log("[Save Data] Starting data saving process..."),console.log("Type in Save Table Data:",c),console.log("Final aRRAY IS inside Save:",u),console.log("Proposed Changes in Save",h);const s=await(0,l.fV)(),t=async(e,t,l)=>(console.log("Fetching URL:",e),console.log("Request Body:",JSON.stringify(t,null,2)),new Promise(((n,r)=>{s.authenticatedRequest(e,{method:l,headers:(0,o.A)((0,o.A)({},a),{},{"Content-Type":"application/json"}),data:JSON.stringify(t),type:"json",onComplete:e=>{console.log("Response received:",e),n(e)},onFailure:e=>{console.error("Request failed:",e),r(e)}})})));let r=i.filter((e=>{if(console.log("Processing prodChild:",e),"released"===e.state.toLowerCase()){console.log("Released prodChild:",e);const s=h.find((s=>s.identifier===e.id&&"modify"===s.action.toLowerCase()));return console.log("Matching change for prodChild:",s),!s}return console.log("prodChild state is not 'released':",e.state),!1}));console.log("NotPropagableChilds ARE :",r);let m=[];u.forEach((e=>{if(e.MBOMValue){let s=[];r.forEach((t=>{t.classes.includes(e.id)||s.push({childId:t.id,childName:t.name})})),s.length>0&&m.push({id:e.id,title:e.title,childs:s,type:e.Type})}}));let p="";console.log("ErrorObj IS",m),m.forEach((e=>{let s="";if(Array.isArray(e.childs)&&e.childs.every((e=>e.childName))){const t=e.childs.map((e=>e.childName)).join(", ");console.log("Chilld Titles are",t),s="new"!==e.type.toLowerCase()?"".concat(e.title," MBOM can't be Make due to unclassified child items: ").concat(t):"Unable to classify product ".concat(e.title," due to unclassified child items: ").concat(t),console.log("Message is:",s)}else s="Invalid child data for ".concat(e.title,".");p+="".concat(s,"\n")})),console.log(m),console.log("Concatenated Messages:\n",p);let f=u.filter((e=>"new"===e.Type.toLowerCase()&&!m.some((s=>s.id===e.id)))).map((e=>e.id));console.log("New Classes are:",f);let y={};u.forEach((e=>{!m.some((s=>s.id===e.id))&&("update"===e.Type.toLowerCase()||"new"===e.Type.toLowerCase()&&e.MBOMValue)&&(y[e.MBOMName]=e.MBOMValue)})),console.log("Update body is:",y);let w=u.filter((e=>e.MBOMValue&&!m.some((s=>s.id===e.id)))).map((e=>e.id));if(console.log("Propogateable classes are",w),f.length>0){let e="https://saasimplementationserverdev.azurewebsites.net/plantAssignment/classifyProductToClass",s={id:n,type:c,classes:f,mode:"classifyParent"};const t=await(0,l.Fd)("POST",e,s);console.log("classifyResponse:",JSON.stringify(t))}if(Object.keys(y).length>0){var g;const s="".concat(e,"/resources/v1/modeler/dslib/dslib:ClassifiedItem/").concat(n),o=await t(s,"","GET");console.log("CStamp Response:",o);let a=(null===(g=o.member[0])||void 0===g?void 0:g.cestamp)||"";y.cestamp=a;const r="https://saasimplementationserverdev.azurewebsites.net/plantAssignment/updateClassificationAttribute?id=".concat(n);await(0,l.Fd)("PATCH",r,y),console.log("Updated database successfully.")}if(w.length>0&&i.length>0&&"VPMReference"===c){let e="https://saasimplementationserverdev.azurewebsites.net/plantAssignment/classifyProductToClass",s={id:n,type:c,classes:w,childs:i,mode:"classifychilds"};const t=await(0,l.Fd)("POST",e,s);console.log("child classifyResponse:",JSON.stringify(t))}if(d.length>0){let e="https://saasimplementationserverdev.azurewebsites.net/plantAssignment/declassifyProductToClass",s={id:n,type:c,classes:d};const t=await(0,l.Fd)("POST",e,s);console.log("declassifyResponse:",JSON.stringify(t))}return console.log("All classification API calls completed successfully."),{success:!0,message:"Data saved successfully",ErrorObj:m,Finalmessage:p}}catch(m){return console.error("Error occurred:",m),{success:!1,message:"Failed to save data",error:m}}}},3353:(e,s,t)=>{t.d(s,{A:()=>c});var o=t(5043),l=t(6313),a=t(7348),n=t(6075),r=t(579);const i=e=>{let{errors:s}=e;const t=(0,o.useMemo)((()=>{const e=s.reduce(((e,s)=>{const t=s.match(/Row (\d+):/),o=s.match(/"([^"]*)" (?:is required|value)/),l=s.split(": ").slice(1).join(": "),a=t?t[1]:"N/A",n=o?o[1]:s.includes("Collaborative Space","Quantity")?"Collaborative Space":"N/A";return e[a]||(e[a]={rowNumber:a,columns:[],errors:[]}),e[a].columns.push(n),e[a].errors.push(l||s),e}),{});return Object.values(e).sort(((e,s)=>Number(e.rowNumber)-Number(s.rowNumber)))}),[s]),l=new a.jS({fixedWidth:!0,defaultHeight:50}),i=e=>{let{key:s,index:o,style:n,parent:i}=e;const c=t[o];return(0,r.jsx)(a.dl,{cache:l,columnIndex:0,rowIndex:o,parent:i,children:(0,r.jsxs)("div",{style:n,className:"table-row",children:[(0,r.jsx)("div",{className:"table-cell",style:{width:"15%"},children:c.rowNumber}),(0,r.jsx)("div",{className:"table-cell",style:{width:"25%"},children:c.columns.map(((e,s)=>(0,r.jsx)("div",{children:e},s)))}),(0,r.jsx)("div",{className:"table-cell",style:{width:"60%"},children:(0,r.jsx)("ul",{className:"error-list",children:c.errors.map(((e,s)=>(0,r.jsx)("li",{children:e},s)))})})]})},s)};return(0,r.jsxs)("div",{className:"error-popup-container",children:[(0,r.jsx)(n.A,{variant:"danger",message:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("strong",{children:"\u26a0\ufe0f Note:"})," Below reports show only uploaded spreadsheet error rows. To resolve these issues, update the spreadsheet and re-import. (",t.length," errors found)"]}),className:"custom-alert"}),(0,r.jsxs)("div",{className:"table-wrapper",children:[(0,r.jsxs)("div",{className:"static-header",children:[(0,r.jsx)("div",{className:"header-cell",style:{width:"15%"},children:"Row Number"}),(0,r.jsx)("div",{className:"header-cell",style:{width:"25%"},children:"Column Name"}),(0,r.jsx)("div",{className:"header-cell",style:{width:"60%"},children:"Error Description"})]}),(0,r.jsx)("div",{className:"table-container",children:(0,r.jsx)(a.t$,{children:e=>{let{height:s,width:o}=e;return(0,r.jsx)(a.B8,{width:o,height:s,rowCount:t.length,rowHeight:l.rowHeight,deferredMeasurementCache:l,rowRenderer:i})}})})]})]})},c=e=>{let{show:s,onHide:t,errors:o}=e;return console.log("[ContentErrorsModal.jsx] errors:",o),(0,r.jsx)(l.A,{show:s,onHide:t,title:"Content Errors",footerButtons:[{label:"Close",variant:"danger",onClick:t}],children:(0,r.jsx)(i,{errors:o})})}},5362:(e,s,t)=>{t.d(s,{A:()=>c});var o=t(5043),l=t(8931),a=t(7111),n=t(3277),r=t(2725),i=t(579);const c=(0,o.forwardRef)(((e,s)=>{let{data:t,columns:c,addedItem:d,CAName:u,state:h}=e;const{showWarningToast:g}=(0,r.A)(),[m,p]=(0,o.useState)({});(0,o.useEffect)((()=>{p({})}),[t]);const f=()=>{const e=w.getSelectedRowModel().rows.map((e=>e.original["Available Plant"]));0!==e.length?(d(e),p({})):g(n.e1)};(0,o.useImperativeHandle)(s,(()=>({addPlant:f})));const y=(0,o.useMemo)((()=>[{id:"select",cell:e=>{let{row:s}=e;return(0,i.jsx)("input",{type:"checkbox",className:"form-check-input",checked:s.getIsSelected(),onChange:s.getToggleSelectedHandler()})}},...c]),[c]),w=(0,l.N4)({data:t,columns:y,state:{rowSelection:m},enableRowSelection:!0,onRowSelectionChange:p,getCoreRowModel:(0,a.HT)()});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("button",{type:"button",className:"btn btn-outline-primary me-3",onClick:()=>{w.getRowModel().rows.forEach((e=>e.toggleSelected(!0)))},children:"Select All"}),(0,i.jsx)("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>{w.getRowModel().rows.forEach((e=>e.toggleSelected(!1)))},children:"Deselect All"})]}),w.getRowModel().rows.length>0?(0,i.jsx)("div",{className:"overflow-auto",style:{maxHeight:"60vh"},children:w.getRowModel().rows.map((e=>(0,i.jsxs)("div",{className:"p-3 border-bottom d-flex align-items-center",style:{backgroundColor:e.getIsSelected()?"#d5e8f2":"inherit"},children:[(0,i.jsx)("div",{className:"me-3",children:(0,l.Kv)(e.getVisibleCells()[0].column.columnDef.cell,e.getVisibleCells()[0].getContext())}),(0,i.jsx)("div",{children:e.original[c[0].accessorKey]})]},e.id)))}):(0,i.jsx)("p",{className:"text-muted p-3",children:"No data available"})]})}))},5658:(e,s,t)=>{t.d(s,{fp:()=>u,uk:()=>h});var o=t(9379),l=t(1238),a=t(9332),n=t(2268),r=t(9722),i=t(184),c=t(579);const d=async e=>{const s=await async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET";console.log("Fetching URL:",e),console.log("Method is:"),console.log("Request Body:",JSON.stringify(s,null,2));try{const o=await(0,r.A)({url:e,method:t,headers:{"Content-Type":"application/json"},data:s});return console.log("Response received:",o.data),o.data}catch(o){throw console.error("Request failed:",o),o}}("https://saasimplementationserverdev.azurewebsites.net/flowDownCA/createMFGCA",e,"POST");return console.log("Manufacturing CA Response:",JSON.stringify(s)),s},u=async(e,s,t,o,a,n,r,i)=>{console.log("[handleFileChange] Function triggered");const c=e.target.files,d=["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],u=Array.from(c).filter((e=>!d.includes(e.type)&&!e.name.toLowerCase().endsWith(".xls")&&!e.name.toLowerCase().endsWith(".xlsx")));if(u.length>0)return o("Only Excel files (.xls, .xlsx) can be uploaded"),e.target.value="",void i(!0);const h=c[0],g=new FileReader;g.onload=async e=>{const c=new Uint8Array(e.target.result),d=l.LF(c,{type:"array"}),u=d.SheetNames[0],g=d.Sheets[u],m=l.Wp.sheet_to_json(g,{header:1});if(console.log("Parsed Excel Data:",m),0===m.length)return o("File is empty"),void i(!0);const p=m[0].map((e=>null===e||void 0===e?void 0:e.toString().trim().toLowerCase()));if(console.log("Normalized Headers:",p),"item"!==p[0]||"plants"!==p[1])return o("File headers are incorrect. Expected headers: 'Item' and 'Plants'"),void i(!0);if(1===m.length)return void o("No data present in the file. Only headers are present.");const f=[];for(let s=1;s<m.length;s++){const e=m[s],t=e[0],o=e[1];!t&&o&&f.push({rowNumber:s+1,columnName:"Item",errorDescription:"Items can't be empty"}),t&&!o&&f.push({rowNumber:s+1,columnName:"Plants",errorDescription:"Plants value is missing"})}if(console.log("Validation Errors:",f),f.length>0){const e=f.map((e=>"Row ".concat(e.rowNumber,': "').concat(e.columnName,'" value ').concat(e.errorDescription)));console.log("[createMFGCA.js] Formatted Errors:",e),s(e),t(!0),i(!0)}else a("File uploaded successfully with no errors"),n(m),r(h),i(!1)},g.onerror=()=>{o("Failed to read the file. Please try again."),i(!0)},g.readAsArrayBuffer(h)},h=async(e,s,t,l)=>{try{const t=await(0,n.I)(),r=(0,o.A)({"Content-Type":"application/json"},t);let u=window.widget.getValue("Credentials");console.log("credentials createMFGCA",u);const h=u.split(".");console.log("credentialsParts",h);const g=h[1];console.log("Company Name:",g);const m=h[2];console.log("Collab Space:",m);const p=await(0,a.g)([m],r,"");console.log("Fetched allPlantsData:",p);const f=await(async(e,s,t,o)=>{const l=[],a=new Set;for(let r=1;r<e.length;r++){const s=e[r];if(s.length>=2&&s[0]&&s[1]){const e=s[0].toString().trim(),t=s[1].toString().includes(",")?s[1].toString().split(",").map((e=>e.trim())):[s[1].toString().trim()];l.push({name:e,plants:t}),t.forEach((e=>a.add(e)))}}const n=[];return a.forEach((e=>{const t=s.find((s=>s.title.replace(/^Plant\s+/,"")===e||s.title===e));t&&n.push({PlantName:t.title.replace(/^Plant\s+/,""),PlantID:t.id})})),{CATitle:"FromAutomation",CAOrganization:t,CACollabSpace:o,CAOwner:"e1331143",Items:l,ParentPlants:n}})(e,p,g,m);console.log("[processManufacturingCA] Manufacturing CA Body (JSON):",JSON.stringify(f,null,2));const y=await d(f);console.log("[processManufacturingCA] Manufacturing CA API Response:",y);const w=null===y||void 0===y?void 0:y.CAName;s((0,c.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,c.jsxs)("span",{children:["Manufacturing CA created successfully! Name: ",(0,c.jsx)("strong",{children:w})]}),(0,c.jsx)("button",{onClick:e=>{e.stopPropagation(),navigator.clipboard.writeText(w)},style:{background:"none",border:"none",cursor:"pointer",marginLeft:"8px",color:"grey"},title:"Copy CA Name",children:(0,c.jsx)(i.zU_,{size:14})})]})),l()}catch(r){console.error("Error in processManufacturingCA:",r),t("Failed to create Manufacturing CA. Please try again.")}}},6075:(e,s,t)=>{t.d(s,{A:()=>a});t(5043);var o=t(4005),l=t(579);const a=e=>{let{variant:s="info",message:t,show:a=!0,className:n=""}=e;return a?(0,l.jsx)(o.A,{variant:s,className:n,children:t}):null}},6313:(e,s,t)=>{t.d(s,{A:()=>n});t(5043);var o=t(4104),l=t(4282),a=t(579);const n=e=>{let{show:s,onHide:t,title:n,children:r,footerButtons:i}=e;return(0,a.jsxs)(o.A,{show:s,onHide:t,size:"lg",centered:!0,children:[(0,a.jsx)(o.A.Header,{closeButton:!0,children:(0,a.jsx)(o.A.Title,{children:n||"Modal Title"})}),(0,a.jsx)(o.A.Body,{children:r}),(0,a.jsx)(o.A.Footer,{children:i?i.map(((e,s)=>(0,a.jsx)(l.A,{variant:e.variant||"secondary",onClick:e.onClick,children:e.label},s))):(0,a.jsx)(l.A,{variant:"secondary",onClick:t,children:"Close"})})]})}}}]);
//# sourceMappingURL=403.f352ee9d.chunk.js.map