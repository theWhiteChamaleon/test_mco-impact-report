"use strict";(self.webpackChunkreact_widget_template=self.webpackChunkreact_widget_template||[]).push([[213],{7881:(e,t,a)=>{a.r(t),a.d(t,{default:()=>I});var n=a(5043),s=a(4391),l=(a(2342),a(9555),a(3003)),o=a(2670),r=a(2115),i=(a(8421),a(4050),a(9959),a(2725)),d=a(6713),c=a(7419),p=a(579);a(45);var u=a(9379),h=(a(4816),a(3637)),m=a(1238),g=a(2450);const b=e=>{let{columns:t,data:a}=e;const[s,l]=(0,n.useState)(""),[o,r]=(0,n.useState)(1),i=(0,n.useMemo)((()=>a.filter((e=>t.some((t=>String(e[t.accessor]).toLowerCase().includes(s.toLowerCase())))))),[s,a,t]),d=(0,n.useMemo)((()=>{const e=10*(o-1);return i.slice(e,e+10)}),[i,o]),c=Math.ceil(i.length/10);return(0,p.jsxs)("div",{className:"container mt-3",children:[(0,p.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[(0,p.jsx)("input",{type:"text",className:"form-control w-50",placeholder:"Search...",value:s,onChange:e=>{l(e.target.value),r(1)}}),(0,p.jsx)("button",{className:"btn btn-success",onClick:()=>{const e=m.Wp.json_to_sheet(i),t=m.Wp.book_new();m.Wp.book_append_sheet(t,e,"Sheet1");const a=m.M9(t,{bookType:"xlsx",type:"array"}),n=new Blob([a],{type:"application/octet-stream"});(0,g.saveAs)(n,"exported-data.xlsx")},children:"Export to Excel"})]}),(0,p.jsx)("div",{className:"table-responsive",children:(0,p.jsxs)("table",{className:"table table-bordered table-hover",children:[(0,p.jsx)("thead",{className:"thead-light",children:(0,p.jsx)("tr",{children:t.map((e=>(0,p.jsx)("th",{children:e.header},e.accessor)))})}),(0,p.jsx)("tbody",{children:d.length>0?d.map(((e,a)=>(0,p.jsx)("tr",{children:t.map((t=>(0,p.jsx)("td",{children:e[t.accessor]},t.accessor)))},a))):(0,p.jsx)("tr",{children:(0,p.jsx)("td",{colSpan:t.length,className:"text-center",children:"No data found."})})})]})}),(0,p.jsxs)("div",{className:"d-flex justify-content-between align-items-center mt-3",children:[(0,p.jsxs)("p",{className:"mb-0",children:["Showing ",10*(o-1)+1," to"," ",Math.min(10*o,i.length)," of"," ",i.length," entries"]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("button",{className:"btn btn-outline-primary mx-1",disabled:1===o,onClick:()=>r((e=>e-1)),children:"Prev"}),(0,p.jsx)("span",{children:o}),(0,p.jsx)("button",{className:"btn btn-outline-primary mx-1",disabled:o===c,onClick:()=>r((e=>e+1)),children:"Next"})]})]})]})};var A=a(759),j=(a(174),a(5645)),v=(a(184),a(3825));const C=e=>{let{plants:t=[],itemId:a,isRemoveMode:n,handleRemovePlant:s}=e;return console.log("PlantRenderer received plants:",t),null!==t&&void 0!==t&&t.length?(0,p.jsx)(p.Fragment,{children:t.map((e=>(0,p.jsxs)("span",{style:{marginRight:"8px",display:"inline-flex",alignItems:"center",color:e.color||"black",fontWeight:"bold"},children:[e.PlantName,n&&"Pending"===e.PlantERPStatus&&(0,p.jsx)(v.zhF,{size:16,style:{cursor:"pointer",color:"red",marginLeft:"4px"},onClick:()=>s(a,e.PlantID)})]},e.PlantID)))}):"N/A"},x=(e,t,a)=>(console.log("cadata datahelpers",a),e?e.map((e=>"Change Action"===t?{ItemName:(null===e||void 0===e?void 0:e.ItemTitle)||"N/A",Plant:(null===e||void 0===e?void 0:e.ItemPlants)||[],ItemId:(null===e||void 0===e?void 0:e.ItemId)||"N/A"}:(console.log("change data datahelper",(null===e||void 0===e?void 0:e.Change)||a.CAName||"N/A"),{Plant:(null===e||void 0===e?void 0:e.title)||"N/A",Seq:(null===e||void 0===e?void 0:e.Seq)||"1",Status:(null===e||void 0===e?void 0:e.PlantStatus)||"Pending","MFG Change":(null===e||void 0===e?void 0:e.MFGChange)||"N/A","MFG Status":(null===e||void 0===e?void 0:e.MFGStatus)||"N/A",Change:(null===e||void 0===e?void 0:e.Change)||a.CAName||"N/A","Change Status":(null===e||void 0===e?void 0:e.ChangeStatus)||a.CAStatus||"N/A","Oracle Template":e.OracleTemplate||"N/A","ERP Status":"Active","ERP Export":"Yes","Lead Plant":!1,MBom:e.MBOM?"Make":"Buy","Sort Value":""}))):[]),f=[{accessorKey:"Available Plant",header:"Available Plant"}];a(3127),a(5362),a(6313),a(3728);a(3277),a(4119),a(1397);var P=a(4675);a(3910);const w=e=>{let{handleFileInputChange:t,fileInputRef:a,isFileInputDisabled:n,handleSubmit:s,isCreateButtonDisabled:l,handleReset:o}=e;const{handleDrop:r}=(0,c.A)(),{performSearch:i}=(0,P.A)();return(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)("div",{className:"droppable-container mt-4",children:[(0,p.jsx)(h.A,{style:{width:"90px",height:"65px"},src:"https://thewhitechamaleon.github.io/testrapp/images/drag.png",alt:"Data Collect"}),(0,p.jsx)("span",{className:"drag-and-drop-text",children:"Drag and Drop"}),(0,p.jsx)("div",{class:"mt-3",children:(0,p.jsxs)("div",{class:"row justify-content-center",children:[(0,p.jsx)("div",{class:"col-6 col-md-auto mb-2"}),(0,p.jsx)("div",{class:"col-6 col-md-auto mb-2"})]})})]})})};var S=a(3353),D=(a(9332),a(2268),a(5658));a(6047);const y=()=>{const{showSuccessToastWithProgress:e,showErrorToastWithProgress:t}=(0,i._)(),[a,s]=(0,n.useState)(!1),[o,r]=(0,n.useState)(null),[m,g]=(0,n.useState)(!1),[v,P]=(0,n.useState)([]),{initializeDroppableArea:y,loading:N}=(0,c.A)(),[I,M]=(0,n.useState)(0),[O,R]=(0,n.useState)([]),[E,F]=(0,n.useState)([]),[k,T]=(0,n.useState)(null),[L,B]=(0,n.useState)([]),[K,q]=(0,n.useState)([]),[G,_]=(0,n.useState)(!1),[U,W]=(0,n.useState)(!0),{handleDrop:V}=(0,c.A)(),[z,H]=(0,n.useState)(!1),[X,Y]=(0,n.useState)(!1),[J,Q]=(0,n.useState)(!1),[Z,$]=(0,n.useState)(!1),ee=(0,l.wA)(),{showSuccessToast:te,showErrorToast:ae}=(0,i.A)();let ne=window.widget.getValue("Credentials");console.log("Security context is: ",ne);const se=(0,n.useRef)(null),le=(0,n.useCallback)(((e,t)=>{q((a=>a.map((a=>a.ItemId===e?(0,u.A)((0,u.A)({},a),{},{ItemPlants:a.ItemPlants.map((e=>e.PlantID===t?(0,u.A)((0,u.A)({},e),{},{color:"red"===e.color?"green":"red"}):e))}):a))))}),[q]);console.log("Table Data after Adding:",O);const oe=(0,l.d4)((e=>e.droppedObject.selectedTableRows)),re=(0,l.d4)((e=>e.droppedObject.droppedObjectData));console.log("droppedObjectData",re);const ie=(0,l.d4)((e=>e.droppedObject.CAItemObjectDetails.CAItemDetails));console.log("The CA Item Details are:",ie);const de=(0,l.d4)((e=>e.droppedObject.CAItemObjectDetails.CAallPlants));console.log("For CA all Plants are: ",de);const ce=(0,l.d4)((e=>e.droppedObject.CAItemObjectDetails.CAheaders));console.log("caheaders plant assign",ce);const pe=(0,l.d4)((e=>e.droppedObject.CAItemObjectDetails.CAisMFGCA));console.log("isMFGCA value is:",pe);const ue=(0,l.d4)((e=>e.droppedObject.loadingParentDetails));console.log("Parents Loading State:",ue);const he=(0,l.d4)((e=>e.droppedObject.plantObjectData.proposedChanges));console.log("Proposed Changes are:",he);const me=(0,l.d4)((e=>e.droppedObject.isDropped)),ge=(0,l.d4)((e=>e.droppedObject.plantObjectData.allPlants));console.log("[MBOMImpactReport] plant object data: ",ge);const be=(0,l.d4)((e=>e.droppedObject.plantObjectData.uniquePlants));console.log("[Plant Assignment] Unique Plants:",be);const Ae=(0,l.d4)((e=>e.droppedObject.plantObjectData.initialAssignedPlants));console.log("The Assigned Plants are:",Ae);const je=(0,l.d4)((e=>e.droppedObject.plantObjectData.CAData));console.log("The CAData is....:",je);const ve=(0,l.d4)((e=>e.droppedObject.plantObjectData.productChildren));console.log("[Plant Assignment] Product Children:",ve);const Ce=(0,l.d4)((e=>e.droppedObject.plantObjectData.CAName));console.log("[plant Assignment] CAName:",Ce);const xe=(0,l.d4)((e=>e.droppedObject.plantObjectData.headers));console.log("[Plant Assignment] Headers are: ",xe);const fe=(0,n.useCallback)((()=>{let e=de.map((e=>e.title.replace(/^Plant /,"")));const t=0===oe.length?O:oe;let a=[...new Set(t.flatMap((e=>{var t;return(null===(t=e.Plant)||void 0===t?void 0:t.map((e=>e.PlantName)))||[]})))],n=e.filter((e=>!a.includes(e))).map((e=>({title:e})));return console.log("Unique table plants are :",n),e.map((e=>({title:e})))}),[de,O,oe,pe]);if(console.log("Tanble Data is:",O),(0,n.useEffect)((()=>{O.length>=0&&M((e=>e+1))}),[O]),re.cardData&&re.initialDraggedData){re.cardData["Maturity State"],re.cardData.HasMBOM;var Pe,we,Se=null===(Pe=re.initialDraggedData)||void 0===Pe||null===(we=Pe.data)||void 0===we?void 0:we.items[0].objectType}const[De,ye]=(0,n.useState)(Ae);console.log("Duplicate Initial Assigned Classes are:",De),(0,n.useEffect)((()=>{ye(Ae),"Change Action"===Se?q(ie):F(Ae)}),[Ae,Se,ie]),(0,n.useEffect)((()=>{"Change Action"===Se&&B(fe())}),[fe,Se]),(0,n.useEffect)((()=>{"Change Action"!==Se&&B(be)}),[be,Se]);(0,n.useEffect)((()=>{me||y()}),[me,y]),(0,n.useEffect)((()=>{H(ue)}),[ue]);const Ne=(0,n.useMemo)((()=>x("Change Action"===Se?K:E,Se,je)),[K,E,Se,je]),Ie=(0,n.useMemo)((()=>(e=>e?e.map((e=>({"Available Plant":(null===e||void 0===e?void 0:e.title)||"N/A"}))):[])(L)),[L]);console.log("[Plant Assignment] Unique Table Data:",Ie);const Me=(0,n.useMemo)((()=>(e=>{if(!e||!e.cardData)return null;const t=e.cardData;let a={title:t.Title||"N/A",type:t.Type||"N/A","Maturity State":t["Maturity State"]||"N/A",owner:t.Owner||"N/A","Collaborative Space Title":t["Collaborative Space Title"]||"N/A",Description:t.Description||"N/A","Dropped Revision":t["Dropped Revision"]||"N/A","Latest Released Revision":t["Latest Released Revision"]||"N/A","CAD Format":t["CAD Format"]||"N/A",imageURL:t.imageURL||"https://oi000186152-us1-space.3dexperience.3ds.com/enovia/snresources/images/icons/large/I_VPMNavProduct108x144.png"};return"Document"!==t.Type&&(a.EIN=t.EIN||"N/A",a["CAD Format"]=t["CAD Format"]||"N/A"),a})(re)),[re]);console.log(Me),(0,n.useEffect)((()=>{Ne.length>=0&&(console.log("New Table Data:",Ne),R(Ne),M((e=>e+1)))}),[Ne]),(0,n.useEffect)((()=>{Q(!!Me)}),[Me]);const Oe=(0,n.useMemo)((()=>((e,t,a,n)=>(console.log("type here is: ",t),"Change Action"===t?[{accessorKey:"ItemName",header:"Item Name"},{accessorKey:"Plant",header:"Plant",cell:e=>{let{row:t}=e;return(0,p.jsx)(C,{plants:t.original.Plant,itemId:t.original.ItemId,isRemoveMode:a,handleRemovePlant:n})}}]:[{accessorKey:"Plant",header:"Plant"},{accessorKey:"Seq",header:"Seq"},{accessorKey:"Status",header:"Status"},{accessorKey:"Change",header:"Change"},{accessorKey:"Change Status",header:"Change Status"},{accessorKey:"MFG Change",header:"MFG Change"},{accessorKey:"MFG Status",header:"MFG Status"},{accessorKey:"Oracle Template",header:"Oracle"},{accessorKey:"MBom",header:"MBom"},{accessorKey:"ERP Status",header:"ERP Status"},{accessorKey:"ERP Export",header:"ERP Export"},{accessorKey:"Lead Plant",header:"Lead Plant"},{accessorKey:"Sort Value",header:"Sort Value"}]))(0,Se,Z,le)),[Ce,Se,Z,le]);(0,n.useMemo)((()=>f),[]);(0,n.useEffect)((()=>{console.log("[MBOMImpactReport] State Changes:",{loading:N,loadingParentDetails:ue,isDropped:me})}),[N,ue,me]);const Re=()=>{r(null),T(null),P([]),g(!1),R([]),B([]),q([]),F([]),ye([]),M(0),_(!1),se.current&&(se.current.value=""),W(!0)};return console.log("Before template render :: columns ::"+Oe),console.log("Before template render :: tableData ::"+O),(0,p.jsxs)(p.Fragment,{children:[X&&(0,p.jsx)(d.A,{}),!me&&!N&&!z&&(0,p.jsx)("div",{style:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between",position:"relative"},children:(0,p.jsx)(w,{handleFileInputChange:e=>{(0,D.fp)(e,P,g,ae,te,r,T,W).finally((()=>{Y(!1)})),_(!0)},fileInputRef:se,isFileInputDisabled:G,handleSubmit:async()=>{if(o){Y(!0);try{await(0,D.uk)(o,e,t,Re)}catch(a){console.error("Error in handleSubmit:",a)}finally{Y(!1)}W(!0)}else ae("Please upload and validate a file before proceeding.")},isCreateButtonDisabled:U,handleReset:Re})}),me&&(0,p.jsxs)(p.Fragment,{children:[N&&(0,p.jsx)(d.A,{}),(0,p.jsx)("div",{className:"content-wrapper py-3 border-bottom",children:(0,p.jsxs)("div",{className:"d-flex ",children:[(0,p.jsx)("div",{className:" p-0 pt-4",children:(0,p.jsx)(h.A,{src:"https://thewhitechamaleon.github.io/testrapp/images/home.png",alt:"home-icon",className:"home-icon",onClick:()=>{y(),ee((0,j.Rr)(!1)),ee((0,j.um)({cardData:{},parentDetails:[],versions:[],initialDraggedData:[]})),ee((0,j.Lq)({allPlants:[],initialAssignedPlants:[],uniquePlants:[],productChildren:[],CAName:!1,headers:{},proposedChanges:[],CAData:{}})),ee((0,j.XC)({CAItemDetails:[],CAallPlants:[],CAisMFGCA:!1,CAheaders:{}})),R([]),Q(!1)}})}),Me&&(0,p.jsx)(A.A,{data:Me,widgetType:"MBOMImpactReport"})]})}),z?(0,p.jsx)("div",{className:"loading-indicator mt-5",children:(0,p.jsx)(d.A,{})}):(0,p.jsx)(p.Fragment,{children:(0,p.jsx)("div",{className:"wrapper-cta",children:(0,p.jsx)(b,{columns:Oe,data:O})})})]}),(0,p.jsx)(S.A,{show:m,onHide:()=>g(!1),errors:v})]})};let N=null;function I(){if(window.widget){let e=!1;window.widget.addEvent("onLoad",(()=>{e?console.warn("[index.js] \u23f3 onLoad was already executed. Ignoring duplicate trigger."):(e=!0,function(){var e,t;requirejs(["DS/PlatformAPI/PlatformAPI"],(e=>{window.PlatformAPI=e}));let a=(null===(e=window.widget)||void 0===e||null===(t=e.body)||void 0===t?void 0:t.querySelector("#root"))||document.getElementById("root");a||(a=document.createElement("div"),a.id="root",window.widget&&window.widget.body?window.widget.body.appendChild(a):document.body.appendChild(a)),N||(N=s.createRoot(a)),N.render((0,p.jsxs)(l.Kq,{store:o.A,children:[(0,p.jsx)(y,{}),(0,p.jsx)(r.N9,{})]}))}())}))}else console.error("[index.js] \u274c Widget not detected! onLoad cannot be registered.")}!function(){if(window.parent&&window.parent.document){let e=window.parent.document.createElement("script");e.textContent='\n    function listenForRefreshClicks() {\n      // console.log("\ud83c\udf0d [Parent] Listening for manual refresh clicks...");\n\n      document.body.addEventListener("click", function (event) {\n        let refreshButton = event.target.closest("#refresh"); // Check if refresh was clicked\n\n        if (refreshButton) {\n          // console.log("\u2705 [Parent] User clicked Refresh!");\n          sessionStorage.setItem("userClickedRefresh", "true"); // Store flag\n          // console.log("Stored Flag:", sessionStorage.getItem("userClickedRefresh"));\n        }\n      }, true);\n    }\n\n    // \u2705 Ensure event listener is added even if DOM is already loaded\n    if (document.readyState === "loading") {\n      document.addEventListener("DOMContentLoaded", listenForRefreshClicks);\n    } else {\n      listenForRefreshClicks();\n    }\n  ',window.parent.document.body.appendChild(e)}else console.warn("\u26a0\ufe0f [index.js] Unable to inject script\u2014parent window not accessible.")}()}}]);
//# sourceMappingURL=213.32bafdba.chunk.js.map